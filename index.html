<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
	</head>
<body>
	<button id="facebook-login">Login</button>
	<div id="fb-root"></div>
	<script src="//connect.facebook.net/en_US/all.js"></script>
	<script>
		var FBUtilities = ( function() {
			var privateProperties = '';

			return {
				login : function() {
					// this pops the login box
					FB.login( function( response ) {
						if ( response.authResponse ) {
							// user has connected
							console.log( response );
						} else {
							// user has cancelled
							console.log( response );
						}
					}, 
					{
						scope: 'publish_actions, user_photos, user_videos, photo_upload, video_upload, email'
					});
				},
				getMe : function() {
					console.log( 'Welcome!  Fetching your information.... ' );
					FB.api('/me', function( response ) {
						console.log( 'Good to see you, ' + response.name + '.' );
						console.log( response );
						App.user = response;
						return App.user;
					});
					return App.user;
				}
			};
		}());
		var App = ( function() {

			return {
				settings : {
					appId : '312553775525906',
				},
				user : {}
			}

		}());
		window.fbAsyncInit = function() {
			FB.init({
				appId: App.settings.appId, // App ID
				channelUrl: '//facebook-app.dev/channel.html',
				status: true,
				cookie: true,
				xfbml: true,
				//oath: true
			});
			FB.getLoginStatus( function( response ) {
				if ( response.status === 'connected' ) {
					console.log( 'login connected:', response );
					// the user is logged in and has authenticated your
					// app, and response.authResponse supplies
					// the user's ID, a valid access token, a signed
					// request, and the time the access token
					// and signed request each expire
					App.settings.accessToken = response.authResponse.accessToken;
					App.settings.signedRequest = response.authResponse.signedRequest;
					console.log( response, App );
					FBUtilities.getMe();
				} else if ( response.status === 'not_authorized' ) {
					console.log( 'logged in, not authorized:', response );
					// the user is logged in to Facebook,
					// but has not authenticated your app
					FBUtilities.login();
				} else {
					console.log( 'not logged in:', response );
					// the user isn't logged in to Facebook.
					FBUtilities.login();
				}
			}, true );
			//FB.api('/me/albums?access_token=' + accessToken, function(response) {})
			FB.Canvas.setAutoGrow();
		}
	</script>
</body>
</html>
